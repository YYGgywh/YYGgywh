# 日历测试页面设计与实现方案

## 1. 页面整体布局结构规划

### 1.1 布局架构
采用现代化的响应式网格布局，主要分为以下几个区域：

- **顶部导航区**：页面标题和功能导航
- **主内容区**：
  - 左侧：转换表单区域（标签页切换不同转换功能）
  - 右侧：结果展示区域
- **底部信息区**：版权信息和帮助链接

### 1.2 响应式设计适配方案

#### 桌面端 (≥ 1024px)
```
┌─────────────────────────────────────────────────────────────┐
│                     顶部导航区                               │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌──────────────────┐  ┌──────────────────────────────────┐ │
│  │  转换表单区域     │  │  结果展示区域                    │ │
│  │  (30% 宽度)      │  │  (70% 宽度)                      │ │
│  └──────────────────┘  └──────────────────────────────────┘ │
│                                                             │
├─────────────────────────────────────────────────────────────┤
│                     底部信息区                               │
└─────────────────────────────────────────────────────────────┘
```

#### 平板端 (768px - 1023px)
```
┌───────────────────────────────────────────┐
│                   顶部导航区                │
├───────────────────────────────────────────┤
│                                           │
│  ┌──────────────────────────────────────┐ │
│  │  转换表单区域                          │ │
│  │  (100% 宽度)                          │ │
│  └──────────────────────────────────────┘ │
│                                           │
│  ┌──────────────────────────────────────┐ │
│  │  结果展示区域                          │ │
│  │  (100% 宽度)                          │ │
│  └──────────────────────────────────────┘ │
│                                           │
├───────────────────────────────────────────┤
│                   底部信息区                │
└───────────────────────────────────────────┘
```

#### 移动端 (< 768px)
```
┌───────────────────────────────────┐
│               顶部导航区            │
├───────────────────────────────────┤
│                                   │
│  ┌──────────────────────────────┐ │
│  │  转换表单区域                  │ │
│  │  (100% 宽度)                  │ │
│  └──────────────────────────────┘ │
│                                   │
│  ┌──────────────────────────────┐ │
│  │  结果展示区域                  │ │
│  │  (100% 宽度)                  │ │
│  └──────────────────────────────┘ │
│                                   │
├───────────────────────────────────┤
│               底部信息区            │
└───────────────────────────────────┘
```

### 1.3 布局实现技术
- 使用CSS Grid和Flexbox组合实现灵活的页面布局
- 采用CSS变量定义断点和布局参数，便于维护
- 使用媒体查询实现不同屏幕尺寸的适配

## 2. 日历组件核心功能需求分析

### 2.1 核心功能模块

#### 2.1.1 日期转换功能
- **公历转农历**：支持选择或输入公历日期，转换为农历日期
- **农历转公历**：支持选择或输入农历日期，转换为公历日期
- **四柱转公历**：支持输入四柱信息，转换为对应的公历日期
- **获取当前时间**：一键获取当前时间的各种历法信息

#### 2.1.2 日期选择器组件
- 支持公历日期选择（年、月、日、时、分、秒）
- 支持农历日期选择（年、月、日、时、分、秒）
- 支持四柱信息输入（年柱、月柱、日柱、时柱）
- 提供日期范围限制和默认值设置

#### 2.1.3 结果展示功能
- 显示转换后的详细日历信息
- 支持多种视图切换（表格视图、卡片视图）
- 支持结果导出和分享
- 提供结果对比功能

### 2.2 交互逻辑流程

#### 2.2.1 转换流程
1. 用户选择转换类型（公历转农历、农历转公历、四柱转公历）
2. 用户输入或选择日期信息
3. 点击转换按钮发起请求
4. 显示加载状态
5. 展示转换结果
6. 支持重新转换或清空结果

#### 2.2.2 错误处理流程
1. 输入验证错误：实时提示用户输入格式错误
2. 请求失败：显示错误信息和重试按钮
3. 无结果：显示友好的提示信息

## 3. UI/UX设计风格规范

### 3.1 设计风格
采用现代化、简洁、专业的设计风格，符合传统文化与现代技术的结合：

- **主色调**：蓝色系（#007bff）作为主色调，象征专业和信任
- **辅助色**：绿色系（#28a745）用于成功状态，红色系（#dc3545）用于错误状态
- **中性色**：白色、浅灰、深灰作为背景和文本颜色，确保良好的可读性
- **传统文化元素**：适当融入传统历法相关的视觉元素，增强文化氛围

### 3.2 排版规范

- **标题字体**：使用无衬线字体（如Inter），加粗显示
- **正文字体**：使用无衬线字体（如Inter），确保清晰易读
- **字号层级**：
  - 页面标题：24px - 32px
  - 区块标题：18px - 24px
  - 正文内容：14px - 16px
  - 辅助文字：12px - 14px

### 3.3 组件设计规范

#### 3.3.1 按钮设计
- 主按钮：蓝色背景，白色文字，圆角设计
- 次要按钮：白色背景，蓝色边框，圆角设计
- 危险按钮：红色背景，白色文字，圆角设计
- 按钮尺寸：标准按钮高度36px，小按钮高度30px

#### 3.3.2 表单元素设计
- 输入框：浅灰色背景，蓝色边框（聚焦时），圆角设计
- 标签：深色文字，清晰的视觉层次
- 验证提示：错误信息红色显示，成功信息绿色显示

#### 3.3.3 卡片设计
- 白色背景，轻微阴影，圆角设计
- 卡片内部边距：16px - 24px
- 卡片标题：加粗显示，底部边框分隔

### 3.4 用户体验优化

- **实时反馈**：操作后立即给予视觉反馈
- **加载状态**：请求过程中显示加载动画
- **错误提示**：清晰明确的错误信息，指导用户如何修正
- **快捷操作**：提供常用日期的快捷选择按钮
- **键盘导航**：支持键盘操作，提高可访问性

## 4. 数据展示格式规范

### 4.1 日历信息展示

#### 4.1.1 基本信息展示
- 公历日期：YYYY-MM-DD HH:MM:SS
- 农历日期：YYYY年MM月DD日 HH:MM:SS
- 星期：中文星期几
- 节气：当前或最近的节气

#### 4.1.2 详细信息展示
采用分组展示的方式，将不同类型的信息分组显示：

- **太阳历信息**：年、月、日、时、分、秒等
- **太阴历信息**：农历年、月、日、时辰等
- **干支信息**：年柱、月柱、日柱、时柱等
- **节气信息**：当前节气、下一个节气等

### 4.2 数据可视化组件

#### 4.2.1 表格视图
使用表格形式展示详细的日历信息，包含字段名称、字段值和说明：

| 字段类型 | 字段名称 | 字段值 | 说明 |
|---------|---------|-------|------|
| 太阳历 | year | 2025 | 公历年 |
| 太阳历 | month | 1 | 公历月 |
| ... | ... | ... | ... |

#### 4.2.2 卡片视图
使用卡片形式展示核心的日历信息，更加直观和简洁：

```
┌─────────────────────────────────────────────┐
│               太阳历信息                     │
├─────────────────────────────────────────────┤
│  年：2025  月：1  日：6  时：22  分：10      │
└─────────────────────────────────────────────┘

┌─────────────────────────────────────────────┐
│               太阴历信息                     │
├─────────────────────────────────────────────┤
│  年：甲辰  月：丁丑  日：癸卯  时：癸亥      │
└─────────────────────────────────────────────┘
```

## 5. 与后端API的数据交互方案

### 5.1 API接口设计

#### 5.1.1 公历转农历接口
- **URL**：`/api/calendar/solar-to-lunar`
- **方法**：POST
- **参数**：
  ```json
  {
    "year": 2025,
    "month": 1,
    "day": 6,
    "hour": 22,
    "minute": 10,
    "second": 0
  }
  ```
- **响应**：
  ```json
  {
    "success": true,
    "message": "转换成功",
    "data": {
      "solar_info": {...},
      "lunar_info": {...},
      "ganzhi_info": {...},
      "jieqi_info": {...}
    }
  }
  ```

#### 5.1.2 农历转公历接口
- **URL**：`/api/calendar/lunar-to-solar`
- **方法**：POST
- **参数**：
  ```json
  {
    "lunar_year": 2025,
    "lunar_month": 1,
    "lunar_day": 6,
    "hour": 22,
    "minute": 10,
    "second": 0
  }
  ```
- **响应**：与公历转农历接口类似

#### 5.1.3 四柱转公历接口
- **URL**：`/api/calendar/pillars-to-solar`
- **方法**：POST
- **参数**：
  ```json
  {
    "year_pillar": "甲辰",
    "month_pillar": "丁丑",
    "day_pillar": "癸卯",
    "hour_pillar": "癸亥"
  }
  ```
- **响应**：包含多个可能的匹配结果

#### 5.1.4 获取当前时间接口
- **URL**：`/api/calendar/current`
- **方法**：GET
- **响应**：与公历转农历接口类似

### 5.2 数据处理流程

1. **请求构建**：根据用户输入构建API请求参数
2. **请求发送**：使用axios发送HTTP请求到后端API
3. **响应处理**：
   - 成功响应：解析响应数据，转换为前端需要的格式
   - 失败响应：处理错误信息，显示友好的错误提示
4. **数据缓存**：对频繁请求的日期数据进行缓存，提高性能
5. **数据转换**：将后端返回的英文键名转换为中文显示

### 5.3 错误处理策略

- **网络错误**：显示网络连接错误，提示用户检查网络
- **服务器错误**：显示服务器错误，提示用户稍后重试
- **参数错误**：显示参数错误，指导用户正确输入
- **业务错误**：显示具体的业务错误信息

## 6. 技术实现方案

### 6.1 前端技术栈

- **框架**：React 18
- **UI组件库**：Ant Design 5.x
- **状态管理**：React Hooks (useState, useEffect)
- **HTTP客户端**：Axios
- **日期处理**：Day.js
- **样式方案**：CSS Modules + Less
- **构建工具**：Vite

### 6.2 组件架构

```
├── CalendarTest (主页面组件)
│   ├── TabNavigation (标签页导航组件)
│   ├── ConvertForm (转换表单组件)
│   │   ├── SolarForm (公历表单子组件)
│   │   ├── LunarForm (农历表单子组件)
│   │   └── PillarsForm (四柱表单子组件)
│   ├── ResultDisplay (结果展示组件)
│   │   ├── TableView (表格视图子组件)
│   │   └── CardView (卡片视图子组件)
│   └── ErrorDisplay (错误显示组件)
```

### 6.3 性能优化方案

- **懒加载**：组件和资源的懒加载
- **缓存机制**：API请求结果的缓存
- **虚拟滚动**：大数据量结果的虚拟滚动展示
- **代码分割**：按功能模块进行代码分割
- **图片优化**：使用合适的图片格式和尺寸

## 7. 测试与部署

### 7.1 测试计划

- **单元测试**：组件和工具函数的单元测试
- **集成测试**：组件之间的集成测试
- **端到端测试**：核心用户流程的端到端测试
- **性能测试**：页面加载和交互性能测试
- **兼容性测试**：不同浏览器和设备的兼容性测试

### 7.2 部署方案

- **开发环境**：本地开发服务器
- **测试环境**：测试服务器部署
- **生产环境**：生产服务器部署，使用CDN加速

## 8. 后续优化计划

- 添加更多历法转换功能
- 支持批量转换和结果导出
- 添加历法知识科普内容
- 优化移动端体验
- 添加用户个性化设置
- 支持多语言切换

---

**设计文档版本**：1.0
**设计日期**：2025-05-08
**设计人**：Frontend Architect